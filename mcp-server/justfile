# Mathesar MCP Server - Build and utility commands

# Install dependencies
install:
	uv sync

# Run the MCP server directly
run:
	python server.py

# Test the MCP server
test:
	python -c "from server import mcp; print('✅ MCP server imports successfully')"

# Show Claude Desktop configuration instructions
install-claude:
	@echo "To install in Claude Desktop:"
	@echo "1. Open Claude Desktop"
	@echo "2. Go to Settings → Developer"
	@echo "3. Edit Config and add this configuration:"
	@echo ""
	@cat claude-config.json
	@echo ""
	@echo "4. Make sure the path points to this directory: $(pwd)"

# Check if Mathesar is running
check-mathesar:
	@curl -s http://localhost:8000/api/rpc/v0/ -d '{"jsonrpc":"2.0","method":"system.listMethods","id":1}' -H "Content-Type: application/json" || echo "❌ Mathesar not running at localhost:8000"

# Clean up Python cache
clean:
	find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null || true
	find . -name "*.pyc" -delete 2>/dev/null || true
